<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>RPG</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" media="screen" href="assets/css/reset.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="assets/css/style.css">
</head>
<body class="bg">
    <div class="container">
            
        <div class="row">
            <div class="col-12">
                <h1 class="text-center" id="page-header">
                    RPG - Black Panther
                </h1>
            </div>
        </div>
        <br>
        <div class="row text-center">
            <div class="col-12" id="fight-narrator">
                Please choose your fighter!!
                
            </div>
            <div class="col-12" >
                <button type="button" class="btn btn-warning" id="again-button">Play Again?</button>
            </div>

            
        </div>
        <br>
   
        <div class="row text-center" id="available-characters">
            <div class="col-2"></div>
            <div class="col-2 game-fighter" id="choice0">
                <img src="assets/images/blackpanther.jpg" class="img-fluid rounded">
                <div class="character-name">Black Panther</div>
                <div class="character-hp" id="hp0">120</div>
            </div>
            <div class="col-2 game-fighter" id="choice1">
                <img src="assets/images/killmonger.jpg" class="img-fluid rounded">
                <div class="character-name">Killmonger</div>
                <div class="character-hp" id="hp1">120</div>
            </div>
            <div class="col-2 game-fighter" id="choice2">
                <img src="assets/images/okoye.jpg" class="img-fluid rounded">
                <div class="character-name">Okoye</div>
                <div class="character-hp" id="hp2">100</div>
            </div>
            <div class="col-2 game-fighter" id="choice3">
                <img src="assets/images/mbaku.jpg" class="img-fluid rounded">
                <div class="character-name">Mbaku</div>
                <div class="character-hp" id="hp3">140</div>
            </div>
            <div class="col-2"></div>
        </div>
        <br>

        <div class="row text-center" id="fight-arena">
            <div class="col-1"></div>
            <div class="col-2" id="your-character"></div>
            <div class="col-2">
                <button type="button" class="btn btn-danger" id="attack-button">Attack</button>
            </div>
            <div class="col-2" id="opponent-character"></div>
            <div class="col-3"></div>
            <div class="col-2">
                <div id="remaining-title">Available Enemies</div>
                
            </div>
        </div>
        <br>

        
    </div>

    <script>
        var fighters = [
            {fighterName: "Black Panther", fighterImage: "assets/images/blackpanther.jpg", hp: 120, baseAttack: 15, currentAttack: 15, counterAttack: 20},
            {fighterName: "Killmonger", fighterImage: "assets/images/killmonger.jpg", hp: 120, baseAttack: 15, currentAttack: 15, counterAttack: 25},
            {fighterName: "Okoye", fighterImage: "assets/images/okoye.jpg", hp: 100, baseAttack: 25, currentAttack: 25, counterAttack: 25},
            {fighterName: "Mbaku", fighterImage: "assets/images/mbaku.jpg", hp: 140, baseAttack: 20, currentAttack: 20, counterAttack: 10}
        ];

               
        $(document).ready(function() {
            var playerCharacter = null;
            var opponentCharacter = null;
            var defeatedOpponents = 0;
            
            $(".game-fighter").on("click", function() {
                if (playerCharacter === null) {
                    var thisDivID = this.id;
                    var thisDiv = $("#"+thisDivID).detach();
                    $("#your-character").append(thisDiv);
                    playerCharacter = parseInt(thisDivID.charAt(6));
                    
                    for (i=0; i<fighters.length;i++) {
                        if (i !== playerCharacter) {
                            thisDiv = $("#choice"+i).detach();
                            $("#remaining-title").append(thisDiv);
                        };
                    };
                    $("#fight-narrator").text("Please choose your 1st opponent!!");
                    $("#remaining-title").css("visibility", "visible");
                } else if (opponentCharacter === null) {
                    var thisDivID = this.id;
                    var thisDiv = $("#"+thisDivID).detach();
                    $("#opponent-character").append(thisDiv);
                    opponentCharacter = parseInt(thisDivID.charAt(6));
                    $("#fight-narrator").text("Attack your opponent!!");
                    $("#attack-button").css("visibility", "visible");
                }
            });


            $("#attack-button").on("click", function(){
                fighters[playerCharacter].hp = fighters[playerCharacter].hp - fighters[opponentCharacter].counterAttack;
                fighters[opponentCharacter].hp = fighters[opponentCharacter].hp - fighters[playerCharacter].currentAttack;
                $("#fight-narrator").html("You attacked " + fighters[opponentCharacter].fighterName + " for " + fighters[playerCharacter].currentAttack + ". <br>" + fighters[opponentCharacter].fighterName + " attacked you for "+ fighters[opponentCharacter].counterAttack +". <br> Continue the attack!!");
                fighters[playerCharacter].currentAttack = fighters[playerCharacter].currentAttack + fighters[playerCharacter].baseAttack;
                
                console.log (fighters[playerCharacter].hp);
                $("#hp"+playerCharacter).text(fighters[playerCharacter].hp);
                $("#hp"+opponentCharacter).text(fighters[opponentCharacter].hp);
                
                if (fighters[playerCharacter].hp <=0) {
                    $("#again-button").css("visibility", "visible");
                    $("#attack-button").css("visibility", "hidden");
                    $("#fight-narrator").text("You've been defeated. GAME OVER!!!");
                    
                    
                } else if (fighters[opponentCharacter].hp <=0) {
                    
                    defeatedOpponents ++;
                    $("#opponent-character").empty();
                    $("#fight-narrator").text("You've defeated " + fighters[opponentCharacter].fighterName + "!! Select next opponet!!");
                    opponentCharacter = null;
                    if (defeatedOpponents === 3) {
                        $("#again-button").css("visibility", "visible");
                        $("#attack-button").css("visibility", "hidden");
                        $("#fight-narrator").text("You've defeated all opponents. You won. Congratulations!!! ");
                    }

                }
                
            });

            $("#again-button").on("click", function(){
                location.reload();
            });



        });
    </script>



    <script src="assets/javascript/game.js"></script>
</body>
</html>